!function(){var e={14385:function(e){"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},73572:function(e,t,n){"use strict";e.exports=n.p+"fc946ea58080ac01f25a.ts"}},t={};function n(r){var c=t[r];if(void 0!==c)return c.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var c=r.length-1;c>-1&&(!e||!/^http(s?):/.test(e));)e=r[c--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,Office.onReady((e=>{e.host===Office.HostType.PowerPoint&&document.getElementById("search-button").addEventListener("click",(async()=>{const e=document.getElementById("search-keyword").value,t=document.getElementById("image-results");t.innerHTML="Searching...";try{const n=await async function(e){const t=await fetch(`https://3af2893f61064f289daa302c5bf46dc0.apig.la-south-2.huaweicloudapis.com/search?keyword=${e}`);return await t.json()}(e);t.innerHTML="",n.forEach((e=>{const n=document.createElement("div"),r=document.createElement("img"),c=document.createElement("button");r.src="data:image/svg+xml;base64,"+btoa(e.data),r.style.width="100px",r.style.margin="10px",c.textContent="Insert",c.addEventListener("click",(()=>async function(e){const t=new Image;t.src=e,t.onload=async()=>{const e=document.createElement("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");if(n){n.drawImage(t,0,0);const r=e.toDataURL("image/png").replace(/^data:image\/png;base64,/,"");Office.context.document.setSelectedDataAsync(r,{coercionType:Office.CoercionType.Image},(e=>{e.status===Office.AsyncResultStatus.Failed&&setMessage("Error: "+e.error.message)}))}}}(r.src))),n.appendChild(r),n.appendChild(c),t.appendChild(n)}))}catch(e){t.innerHTML="Error occurred while searching images."}}))})),function(){"use strict";var e=n(14385),t=n.n(e),r=new URL(n(73572),n.b);t()(r)}()}();
//# sourceMappingURL=taskpane.js.map